m=[0 0; 0 2]';
S(:,:,1)=[0.2 0; 0 0.2];
S(:,:,2)=[0.2 0; 0 0.2];
P=[1/3 2/3];
N=10000;
randn('seed',0);
[X]=generate_gauss_classes(m,S,P,N);
x1=-5:0.1:5;
x2=-5:0.1:5;
pdfx=(1/3)*(1/sqrt(2*pi*0.2))*exp(-((x1.^2)+(x2.^2))/0.4)+(2/3)*(1/sqrt(2*pi*0.2))*exp(-(((x2-2).^2)+(x1.^2))/0.4);
plot(x1, pdfx); hold;
h=0.1;
pdfx_approx=Parzen_gauss_kernel(X,h,-5,5);
plot(-5:h:5, pdfx_approx,'r');